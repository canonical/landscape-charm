# Copyright 2025 Canonical Ltd
# See LICENSE file for licensing details.

# For a complete list of supported options, see:
# https://juju.is/docs/sdk/metadata-reference
name: landscape-server
display-name: Landscape Server
description: A multi-server Self-Hosted Landscape Server charm.
maintainers:
  - Landscape Developers <landscape-devel@lists.canonical.com>
summary: Charm for installing and using Self-Hosted Landscape Server.

requires:
  database:
    interface: postgresql_client
  db:
    # Provide backwards compatibility
    # with the legacy Postgres interface
    interface: pgsql
  inbound-amqp:
    interface: rabbitmq
  outbound-amqp:
    interface: rabbitmq
  application-dashboard:
    interface: register-application
  landscape-ping:
    interface: ingress
    limit: 1
  landscape-appserver:
    interface: ingress
    limit: 1
  landscape-message-server:
    interface: ingress
    limit: 1
  landscape-api:
    interface: ingress
    limit: 1
  landscape-package-upload:
    interface: ingress
    limit: 1

provides:
  data:
    interface: block-storage
    scope: container
    optional: true
  hosted:
    interface: landscape-hosted
    scope: container
  nrpe-external-master:
    interface: nrpe-external-master
    scope: container
  cos-agent:
    interface: cos_agent

peers:
  replicas:
    interface: landscape-replica
